import{$ as M,A as y,B as _,H as l,I as L,K as C,L as k,N as f,O as w,P as T,Q as o,R as s,S as x,T as A,U as P,V as h,W as z,X as W,Y as V,Z as d,_ as u,aa as U,b as S,ba as ee,ca as te,d as se,da as ne,ea as q,fa as ie,ja as K,ka as G,la as H,ma as X,na as $,ra as ae,ta as ce,u as R,va as le,wa as de,y as N,ya as me,za as j}from"./chunk-J7IGW6KX.js";var Q=class{constructor(m){this.p5=m,this.animation=null,this.progress=0,this.isPlaying=!1}startAnimation(m){this.animation=m,this.progress=0,this.isPlaying=!0}stopAnimation(){this.isPlaying=!1,this.animation=null}update(m){!this.isPlaying||!this.animation||(this.progress+=m/this.animation.duration,this.progress>=1&&(this.progress=0))}draw(){let m=this.animation;if(!m||!this.isPlaying)return;let e=this.p5,n=m.path.length,t=Math.floor(this.progress*n),i=25;e.push();for(let r=Math.max(0,t-i);r<t;r++){let c=m.path[r],g=m.path[r+1];if(!g)continue;let v=255*(1-(t-r)/i),b=2+(m.pressureProfile?.[r]??.7)*6;e.stroke(200,220,255,v),e.strokeWeight(b),e.strokeCap(e.ROUND),e.noFill(),e.line(c.x,c.y,g.x,g.y)}if(t<n){let r=m.path[t],c=m.pressureProfile?.[t]??.7,g=18+Math.sin(this.progress*Math.PI*6)*4;e.noStroke(),e.fill(200,220,255,25),e.ellipse(r.x,r.y,44,44),e.noFill(),e.stroke(200,220,255,120),e.strokeWeight(1.5),e.ellipse(r.x,r.y,g,g),e.noStroke(),e.fill(220,235,255,210);let p=10+c*8;e.ellipse(r.x,r.y,p,p)}e.pop()}get isActive(){return this.isPlaying}};var J=(()=>{class a{constructor(){this.KEY="shilparangoli-onboarding-complete",this.isOnboardingComplete=C(!1),this.currentStep=C(0),this.steps=[{id:"grip_introduction",title:"Step 1 \xB7 The Sacred Grip",description:"Watch the ghost hand hold the virtual brush. Notice the steady pressure \u2014 never tense, never limp.",demoAnimation:{type:"pressure-demo",duration:5e3,path:this.straightLinePath(),pressureProfile:this.constantPressure(.7,100),label:"Constant 70% pressure \u2014 notice the steady line width"},validation:{metric:"pressureConsistency",threshold:.2,feedbackMessage:"Try to match the ghost hand's steady pressure"},minAttempts:2,successThreshold:.65,hints:["Rest your ring and pinky fingers on the desk","Wrist stays relaxed \u2014 never tense","Think of holding a delicate grain of rice"]},{id:"velocity_control",title:"Step 2 \xB7 Steady as a Stream",description:"The ghost hand moves at a constant speed. Your line should flow like honey \u2014 smooth and unbroken.",demoAnimation:{type:"velocity-demo",duration:6e3,path:this.curvedPath(),label:"Constant speed along an S-curve",audioHint:"Match the rhythm of your breathing to the motion"},validation:{metric:"velocityConsistency",threshold:.25,feedbackMessage:"Your speed is too jerky. Breathe out slowly as you draw."},minAttempts:2,successThreshold:.65,hints:["Exhale slowly as you draw the line","Don't focus on the cursor tip \u2014 see the whole line","Pretend you're drawing through honey"]},{id:"angle_awareness",title:"Step 3 \xB7 The Compass Within",description:"Draw four strokes at perfect 90\xB0 angles from the center. Imagine a clock: 12, 3, 6, 9.",demoAnimation:{type:"angle-demo",duration:8e3,path:this.radialPath(4),label:"4-fold radial strokes at 0\xB0, 90\xB0, 180\xB0, 270\xB0"},validation:{metric:"angularPrecision",threshold:8,feedbackMessage:"Use the clock face: pivot your wrist at the center"},minAttempts:2,successThreshold:.6,hints:["Your wrist is the pivot \u2014 rotate, don't translate","Visualize a clock overlay on the canvas",'Count out loud: "Twelve\u2026 three\u2026 six\u2026 nine\u2026"']}];let e=localStorage.getItem(this.KEY);this.isOnboardingComplete.set(e==="true")}completeOnboarding(){localStorage.setItem(this.KEY,"true"),this.isOnboardingComplete.set(!0)}resetOnboarding(){localStorage.removeItem(this.KEY),this.isOnboardingComplete.set(!1),this.currentStep.set(0)}nextStep(){let e=this.currentStep()+1;e>=this.steps.length?this.completeOnboarding():this.currentStep.set(e)}straightLinePath(){return Array.from({length:100},(e,n)=>({x:60+n*2.8,y:200}))}curvedPath(){let e=[];for(let n=0;n<=1;n+=.01)e.push({x:60+n*360,y:200+Math.sin(n*Math.PI*2)*70});return e}radialPath(e){let r=[];for(let c=0;c<e;c++){let g=c*360/e*(Math.PI/180);for(let p=0;p<=20;p++){let v=p/20;r.push({x:240+Math.cos(g)*120*v,y:200+Math.sin(g)*120*v})}for(let p=0;p<5;p++)r.push({x:240+Math.cos(g)*120,y:200+Math.sin(g)*120})}return r}constantPressure(e,n){return Array(n).fill(e)}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275prov=R({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var _e=["demoCanvas"];function xe(a,m){if(a&1&&x(0,"span",25),a&2){let e=m.index,n=h();T("active",e===n.stepIndex)("done",e<n.stepIndex)}}function Pe(a,m){if(a&1&&(o(0,"div",26)(1,"span",27),d(2,"\u{1F4A1}"),s(),o(3,"p"),d(4),s()()),a&2){let e=h();l(4),u(e.lastHint)}}function Ce(a,m){if(a&1&&(o(0,"p",28),d(1),s()),a&2){let e=h();l(),U(" Draw on the canvas above to unlock this step (",e.attemptsOnStep,"/",e.currentStep.minAttempts," attempts) ")}}function ke(a,m){a&1&&(o(0,"p",28),d(1," Double-tap to clear \xB7 Draw on the canvas to practice "),s())}var pe=(()=>{class a{constructor(e,n){this.onboarding=e,this.cdr=n,this.stepIndex=0,this.pressureScore=C(0),this.velocityScore=C(0),this.attemptsOnStep=0,this.lastHint="",this.canAdvance=C(!1),this.demoReady=C(!1),this.stageLabel=G(()=>`${this.stepIndex+1} of ${this.steps.length}`),this.sketch=null,this.userPoints=[],this.pressureSamples=[],this.steps=e.steps,this.currentStep=this.steps[0]}ngOnInit(){}ngAfterViewInit(){this.initSketch()}ngOnDestroy(){this.sketch?.remove(),this.sketch=null}initSketch(){if(!this.demoRef)return;this.sketch?.remove();let e=this.demoRef.nativeElement,n=t=>{let i;this.ghost=new Q(t),t.setup=()=>{t.createCanvas(e.offsetWidth||480,e.offsetHeight||260),i=t.createGraphics(t.width,t.height),t.frameRate(60),this.ghost.startAnimation(this.currentStep.demoAnimation),this.demoReady.set(!0)},t.draw=()=>{t.background(20,18,35),t.stroke(255,255,255,10),t.strokeWeight(1);for(let r=40;r<t.width;r+=40)t.line(r,0,r,t.height);for(let r=40;r<t.height;r+=40)t.line(0,r,t.width,r);if(this.currentStep.demoAnimation.type==="angle-demo"&&(t.stroke(255,255,255,20),t.strokeWeight(1),t.line(t.width/2,0,t.width/2,t.height),t.line(0,t.height/2,t.width,t.height/2)),t.image(i,0,0),this.ghost.update(t.deltaTime),this.ghost.draw(),t.mouseIsPressed&&this.isInsideCanvas(t)){let r=t.pressure??this.velocityToFakePressure();i.stroke(255,107,157,200),i.strokeWeight(3+r*5),i.strokeCap(t.ROUND),i.line(t.pmouseX,t.pmouseY,t.mouseX,t.mouseY),this.userPoints.push({x:t.mouseX,y:t.mouseY,t:t.millis()}),this.pressureSamples.push(r)}},t.mouseReleased=()=>{this.userPoints.length>2&&(this.evaluateStroke(),this.userPoints=[],this.pressureSamples=[])},t.doubleClicked=()=>(i.clear(),!1)};this.sketch=new j(n,e)}isInsideCanvas(e){return e.mouseX>=0&&e.mouseX<=e.width&&e.mouseY>=0&&e.mouseY<=e.height}velocityToFakePressure(){return .7}evaluateStroke(){return S(this,null,function*(){this.attemptsOnStep++;let e=this.computePressureScore(this.pressureSamples),n=this.computeVelocityScore(this.userPoints),t=0,i=this.currentStep.validation;i.metric==="pressureConsistency"?t=e:i.metric==="velocityConsistency"?t=n:i.metric==="angularPrecision"&&(t=this.computeAngleScore()),this.pressureScore.set(Math.round(e*100)),this.velocityScore.set(Math.round(n*100));let r=t>=this.currentStep.successThreshold;r&&this.attemptsOnStep>=this.currentStep.minAttempts&&this.canAdvance.set(!0);let c=this.attemptsOnStep%this.currentStep.hints.length;this.lastHint=r?"":this.currentStep.hints[c],this.cdr.markForCheck()})}computePressureScore(e){if(e.length<2)return 1;let n=e.reduce((i,r)=>i+r,0)/e.length,t=Math.sqrt(e.reduce((i,r)=>i+Math.pow(r-n,2),0)/e.length);return Math.max(0,Math.min(1,1-t/.2))}computeVelocityScore(e){if(e.length<3)return 1;let n=[];for(let c=1;c<e.length;c++){let g=e[c].t-e[c-1].t;if(g<=0)continue;let p=Math.hypot(e[c].x-e[c-1].x,e[c].y-e[c-1].y);n.push(p/g)}if(!n.length)return 1;let t=n.reduce((c,g)=>c+g,0)/n.length;if(t===0)return 1;let r=Math.sqrt(n.reduce((c,g)=>c+Math.pow(g-t,2),0)/n.length)/t;return Math.max(0,Math.min(1,1-r/.3))}computeAngleScore(){return this.userPoints.length>10?.75:.4}advance(){let e=this.stepIndex+1;if(e>=this.steps.length){this.onboarding.completeOnboarding();return}this.stepIndex=e,this.currentStep=this.steps[e],this.attemptsOnStep=0,this.canAdvance.set(!1),this.lastHint="",this.pressureScore.set(0),this.velocityScore.set(0),this.ghost&&this.ghost.startAnimation(this.currentStep.demoAnimation),this.cdr.markForCheck()}skip(){this.onboarding.completeOnboarding()}static{this.\u0275fac=function(n){return new(n||a)(L(J),L(K))}}static{this.\u0275cmp=N({type:a,selectors:[["app-onboarding"]],viewQuery:function(n,t){if(n&1&&z(_e,5),n&2){let i;W(i=V())&&(t.demoRef=i.first)}},standalone:!0,features:[q],decls:40,vars:20,consts:[["demoCanvas",""],[1,"onboarding-overlay"],["role","dialog","aria-labelledby","ob-title",1,"onboarding-card"],[1,"step-track"],[1,"step-dots"],["class","dot",3,"active","done",4,"ngFor","ngForOf"],[1,"step-label"],["id","ob-title",1,"step-title"],[1,"step-description"],[1,"demo-area"],[1,"canvas-host"],[1,"canvas-label"],[1,"dot-blink"],[1,"metric-bars"],[1,"metric-bar"],[1,"metric-name"],[1,"bar-track"],[1,"bar-fill","pressure"],[1,"metric-val"],[1,"bar-fill","velocity"],["class","hint-box",4,"ngIf"],[1,"actions"],[1,"skip-btn",3,"click"],[1,"next-btn",3,"click","disabled"],["class","attempt-note",4,"ngIf"],[1,"dot"],[1,"hint-box"],[1,"hint-icon"],[1,"attempt-note"]],template:function(n,t){if(n&1){let i=A();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),k(4,xe,1,4,"span",5),s(),o(5,"span",6),d(6),s()(),o(7,"h2",7),d(8),s(),o(9,"p",8),d(10),s(),o(11,"div",9),x(12,"div",10,0),o(14,"div",11),x(15,"span",12),d(16),s()(),o(17,"div",13)(18,"div",14)(19,"span",15),d(20,"Grip Steadiness"),s(),o(21,"div",16),x(22,"div",17),s(),o(23,"span",18),d(24),s()(),o(25,"div",14)(26,"span",15),d(27,"Flow Smoothness"),s(),o(28,"div",16),x(29,"div",19),s(),o(30,"span",18),d(31),s()()(),k(32,Pe,5,1,"div",20),o(33,"div",21)(34,"button",22),P("click",function(){return y(i),_(t.skip())}),d(35,"Skip Tutorial"),s(),o(36,"button",23),P("click",function(){return y(i),_(t.advance())}),d(37),s()(),k(38,Ce,2,2,"p",24)(39,ke,2,0,"p",24),s()()}n&2&&(l(4),f("ngForOf",t.steps),l(2),u(t.stageLabel()),l(2),u(t.currentStep.title),l(2),u(t.currentStep.description),l(6),M(" ",t.currentStep.demoAnimation.label," "),l(2),T("highlighted",t.currentStep.validation.metric==="pressureConsistency"),l(4),w("width",t.pressureScore(),"%"),l(2),M("",t.pressureScore(),"%"),l(),T("highlighted",t.currentStep.validation.metric==="velocityConsistency"),l(4),w("width",t.velocityScore(),"%"),l(2),M("",t.velocityScore(),"%"),l(),f("ngIf",t.lastHint),l(4),f("disabled",!t.canAdvance()),l(),M(" ",t.stepIndex<t.steps.length-1?"Next \u2192":"Begin Practice \u2728"," "),l(),f("ngIf",!t.canAdvance()&&t.attemptsOnStep>0),l(),f("ngIf",!t.canAdvance()&&t.attemptsOnStep===0))},dependencies:[$,H,X],styles:["[_nghost-%COMP%]{display:block;position:fixed;inset:0;z-index:200;background:#111117f5;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fade-in .4s ease forwards}.onboarding-card[_ngcontent-%COMP%]{width:min(560px,96vw);background:#1e1e24;border:1px solid hsla(0,0%,100%,.08);border-radius:24px;padding:2.5rem 2rem;animation:_ngcontent-%COMP%_scale-in .4s cubic-bezier(0,0,.2,1) forwards;box-shadow:0 24px 60px #0a0a0f99}.step-track[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.step-dots[_ngcontent-%COMP%]{display:flex;gap:.5rem}.dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#fff3;transition:background .3s,transform .3s}.dot.active[_ngcontent-%COMP%]{background:#fb5189;transform:scale(1.3)}.dot.done[_ngcontent-%COMP%]{background:#2dd272}.step-label[_ngcontent-%COMP%]{font-size:.75rem;letter-spacing:.08em;color:#ffffff73;text-transform:uppercase}.step-title[_ngcontent-%COMP%]{font-family:Crimson Pro,Georgia,serif;font-size:1.55rem;color:#fb5189;margin:0 0 .5rem;line-height:1.2}.step-description[_ngcontent-%COMP%]{font-size:.9rem;color:#ffffffb3;line-height:1.6;margin:0 0 1.25rem}.demo-area[_ngcontent-%COMP%]{border-radius:14px;overflow:hidden;border:1px solid hsla(0,0%,100%,.07);background:#111117;margin-bottom:1.25rem}.canvas-host[_ngcontent-%COMP%]{width:100%;height:200px;cursor:crosshair}.canvas-host[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;width:100%!important;height:100%!important}.canvas-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;font-size:.72rem;color:#ffffff59;padding:.45rem .75rem;border-top:1px solid hsla(0,0%,100%,.04)}.dot-blink[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#fb5189;animation:_ngcontent-%COMP%_pulse-blink 1.5s ease infinite}@keyframes _ngcontent-%COMP%_pulse-blink{0%,to{opacity:1}50%{opacity:.3}}.metric-bars[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;margin-bottom:1rem}.metric-bar[_ngcontent-%COMP%]{display:grid;grid-template-columns:130px 1fr 46px;align-items:center;gap:.75rem;opacity:.45;transition:opacity .3s}.metric-bar.highlighted[_ngcontent-%COMP%]{opacity:1}.metric-name[_ngcontent-%COMP%]{font-size:.75rem;color:#fff9}.bar-track[_ngcontent-%COMP%]{height:6px;background:#ffffff14;border-radius:3px;overflow:hidden}.bar-fill[_ngcontent-%COMP%]{height:100%;border-radius:3px;transition:width .4s ease}.bar-fill.pressure[_ngcontent-%COMP%]{background:linear-gradient(90deg,#b152e0,#fb5189)}.bar-fill.velocity[_ngcontent-%COMP%]{background:linear-gradient(90deg,#2bbdee,#2dd272)}.metric-val[_ngcontent-%COMP%]{font-size:.72rem;font-family:JetBrains Mono,monospace;color:#fb5189;text-align:right}.hint-box[_ngcontent-%COMP%]{display:flex;gap:.6rem;background:#ffc61a14;border:1px solid hsla(45,100%,55%,.2);border-radius:10px;padding:.7rem .9rem;margin-bottom:1rem;animation:_ngcontent-%COMP%_slide-in-bottom .3s ease}.hint-box[_ngcontent-%COMP%]   .hint-icon[_ngcontent-%COMP%]{font-size:1rem;flex-shrink:0}.hint-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.82rem;color:#f9dc86;line-height:1.5}.actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;align-items:center}.skip-btn[_ngcontent-%COMP%]{background:transparent;color:#ffffff59;border:none;cursor:pointer;font-size:.82rem;padding:.5rem .75rem;border-radius:8px;transition:color .2s}.skip-btn[_ngcontent-%COMP%]:hover{color:#ffffffa6}.next-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fb5189,#ee4b2b);color:#fff;border:none;padding:.65rem 1.8rem;border-radius:30px;cursor:pointer;font-size:.9rem;font-weight:600;letter-spacing:.02em;transition:opacity .2s,transform .2s,box-shadow .2s;box-shadow:0 4px 16px #fb518959}.next-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.04);box-shadow:0 6px 24px #fb518980}.next-btn[_ngcontent-%COMP%]:disabled{opacity:.35;cursor:not-allowed;box-shadow:none}.attempt-note[_ngcontent-%COMP%]{text-align:center;font-size:.75rem;color:#ffffff4d;margin:.5rem 0 0}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scale-in{0%{opacity:0;transform:scale(.94)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_slide-in-bottom{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}"]})}}return a})();var Y=[{stage:1,stageName:"Foundation",technique:"Pinch Grip Mastery",guideItems:[{icon:"\u{1F44C}",title:"Three-Finger Hold",description:"Thumb, index, middle\u2014like holding a grain of rice. Ring and pinky rest on table for stability."},{icon:"\u{1F3AF}",title:"Pressure Sweet Spot",description:"Aim for 60\u201380% pressure. Too light = shaky lines. Too hard = hand fatigue."},{icon:"\u{1F504}",title:"Wrist Pivot Point",description:"Your wrist is the compass center. Fingers control detail, wrist controls curves."},{icon:"\u23F1\uFE0F",title:"Practice Rhythm",description:"3 sets \xD7 5 strokes. Rest 30 seconds between sets. Quality over quantity."}],culturalContext:{tradition:"Tamil Kolam",practitioner:"Expert kolam artists develop calluses on these three fingers after years of daily practice.",citation:'Dr. Vijaya Nagarajan, "Threshold Designs" (2018)'},drills:["Straight Line Pressure Hold \u2014 maintain \u03C3 < 0.12","Concentric Circle Consistency \u2014 3 circles, \u03C3 < 0.15","Dot Grid Precision \u2014 5\xD75 grid at 75% pressure","Petal Stroke Sequence \u2014 8 symmetrical petals","Speed\u2013Pressure Decoupling \u2014 same pressure at 3 speeds"],passThreshold:"80%+ on 4 out of 5 drills"},{stage:2,stageName:"Control",technique:"Controlled Release Dynamics",guideItems:[{icon:"\u{1F30A}",title:"Flow Like Water",description:"Imagine pouring honey\u2014steady, continuous, never jerky. Your hand should feel weightless."},{icon:"\u{1F3B5}",title:"Listen to Your Speed",description:"Enable audio feedback. A steady tone = perfect control. Pitch changes = speed wobbles."},{icon:"\u{1F441}\uFE0F",title:"Peripheral Vision Trick",description:"Don't stare at the cursor. Soften your gaze to see the whole pattern. Masters draw 'blind'."},{icon:"\u{1F4A8}",title:"Breath Sync",description:"Exhale during strokes. Inhale during pauses. This is Zen archery applied to art."}],culturalContext:{tradition:"Rajasthani Mandana",practitioner:"Village artists create 10-meter murals in one breath-controlled session.",citation:"Gujarat Folk Arts Museum, Field Study 2019"},drills:["Velocity Staircase \u2014 3, 5, 7 cm/s segments","Spiral Consistency \u2014 outward spiral at constant speed","Pulsed Line Texture \u2014 dotted line via pulsed motion","Figure-8 Infinity Loop \u2014 30 second continuous loop","Blindfold Mode \u2014 draw straight line from muscle memory"],passThreshold:"85%+ on 4 out of 5 drills"},{stage:3,stageName:"Symmetry",technique:"Radial Precision",guideItems:[{icon:"\u{1F9ED}",title:"Mental Compass",description:"Imagine a clock face. 12, 3, 6, 9 = perfect 4-fold. Use this as your anchor."},{icon:"\u{1F522}",title:"Count Your Angles",description:'Whisper the divisions out loud: "45\u2026 90\u2026 135\u2026" Verbal encoding improves motor accuracy.'},{icon:"\u{1F3AF}",title:"Pivot From Center",description:"Your wrist is the compass point. Small wrist rotation = big arc on the edge."},{icon:"\u{1FA9E}",title:"Mirror Check",description:"After each stroke, imagine folding the canvas. Would the halves match?"}],culturalContext:{tradition:"Tamil Kolam",practitioner:"Traditional kolam use 'pulli' (dot grids) as built-in angle guides.",citation:'Ascher, M. "Ethnomathematics" (1991)'},drills:["Cardinal Directions \u2014 4 dots at 0\xB0, 90\xB0, 180\xB0, 270\xB0","Octagon Construction \u2014 8 petals at 45\xB0 intervals","Speed\u2013Accuracy Tradeoff \u2014 8-fold in 60s / 45s / 30s","Inverted Symmetry \u2014 draw pattern rotated 180\xB0","Hybrid Symmetry \u2014 4-fold primary + 8-fold secondary"],passThreshold:"90%+ on 4-fold and 6-fold accuracy"},{stage:4,stageName:"Composition",technique:"Stroke Order Mastery",guideItems:[{icon:"\u{1F338}",title:"Bloom From Center",description:"Like a real flower: seed \u2192 petals \u2192 leaves. Never draw leaves before petals."},{icon:"\u{1F3BC}",title:"Visual Music",description:"Each stroke is a note. Wrong order = dissonant chord. Right order = harmony."},{icon:"\u{1F9D8}",title:"Meditative Sequence",description:"Traditional artists chant mantras synced to stroke order. Rhythm creates flow."},{icon:"\u{1F517}",title:"Continuous Line",description:"Advanced: Draw entire pattern without lifting. Requires perfect sequence planning."}],culturalContext:{tradition:"Bengali Alpana",practitioner:"Alpana artists use specific stroke sequences passed down orally through generations.",citation:"Santiniketan Archives, Oral History Project (2015)"},drills:["Linear Sequence \u2014 3-layer center \u2192 petals \u2192 ring","Speed Sequence Challenge \u2014 8-layer in 90 seconds","Memory Sequence \u2014 study 30s, then draw without hints","Interrupted Sequence \u2014 15s forced pause every 10 strokes","Adaptive Sequencing \u2014 user-defined order validated by AI"],passThreshold:"95%+ sequence compliance on 3 patterns"},{stage:5,stageName:"Mastery",technique:"Flow State Achievement",guideItems:[{icon:"\u{1F30A}",title:"Effortless Effort",description:"Stop trying. Let your hand draw itself. You're just watching."},{icon:"\u23F0",title:"Time Collapse",description:"If you're checking the clock, you're not in flow. True mastery feels timeless."},{icon:"\u{1F3AD}",title:"Lose Yourself",description:"The boundary between you and the canvas dissolves. This is 'no-mind'."},{icon:"\u{1F525}",title:"Challenge\u2013Skill Balance",description:"Flow occurs when task difficulty perfectly matches your ability. We'll auto-adjust."}],culturalContext:{tradition:"Universal (Zen, Sufism, Tamil Kolam)",practitioner:"Master artists describe entering 'trance states' where patterns emerge spontaneously.",citation:'Csikszentmihalyi, M. "Flow" (1990)'},drills:["Timed Mastery Pattern \u2014 12-fold with zero UI feedback","Blindfold Mastery \u2014 audio cues only","Ambient Mastery \u2014 draw with distractions (<10% performance drop)","Teaching Mode \u2014 explain while drawing (dual-task)","Improvisational Mastery \u2014 create original pattern"],passThreshold:"Flow Index > 0.85 on 3 different pattern families"}];var re=function(a){return a[a.Foundation=1]="Foundation",a[a.Control=2]="Control",a[a.Symmetry=3]="Symmetry",a[a.Composition=4]="Composition",a[a.Mastery=5]="Mastery",a}(re||{});var he=(()=>{class a{getPatterns(){let e=[];for(let n=1;n<=50;n++)e.push(this.createPattern(n));return e}createPattern(e){let n=1,t=4,i=`Pattern ${e}`,r="A simple geometric design.";return e<=5?(n=1,t=4,i="Simple Flower",r="Foundational 4-petal motif common in daily threshold designs."):e<=15?(n=2,t=6,i="Hexa Star",r="Six-pointed star representing balance in nature."):e<=25?(n=3,t=8,i="Lotus Mandala",r="The Lotus (Padma) symbolizes purity and spiritual awakening."):e<=35?(n=4,t=10,i="Sun Ray",r="Dedicated to Surya, the Sun God, for vitality."):(n=5,t=12+e%2*4,i="Royal Peacock",r="Intricate peacock feather motifs (Mayura) for prosperity."),e===1?this.pattern1_SimpleFlower():e===2?this.pattern2_DottedSquare():e===3?this.pattern3_SixPointStar():e===16?this.pattern16_LotusMandala():e===36?this.pattern36_PeacockBloom():{id:e,name:`${i} Var. ${e}`,difficulty:n,symmetryAxes:t,culturalNote:r,layers:[],generate:(c,g,p,v)=>{let O=2+Math.floor(e/10);c.push(),c.translate(g,p);for(let b=0;b<O;b++){let I=v*(.2+b*.2),F=t*(1+b%2),D=(e*10+b*40)%360;if(c.noFill(),c.stroke(D,80,90),c.strokeWeight(2),b%3===0)c.ellipse(0,0,I*2);else if(b%3===1)for(let E=0;E<360;E+=360/F)c.push(),c.rotate(c.radians(E)),c.ellipse(I,0,I*.5,I*.3),c.pop();else{c.fill(D,80,90),c.noStroke();for(let E=0;E<360;E+=360/F){let Z=c.cos(c.radians(E))*I,be=c.sin(c.radians(E))*I;c.circle(Z,be,5)}}}c.pop()}}}pattern1_SimpleFlower(){return{id:1,name:"Simple Flower",difficulty:1,symmetryAxes:4,layers:[],culturalNote:"A basic 4-petaled flower, often drawn by beginners in Southern India.",generate:(e,n,t,i)=>{e.push(),e.translate(n,t),e.noStroke(),e.fill("#FF6B9D");for(let r=0;r<4;r++)e.push(),e.rotate(e.TWO_PI/4*r),e.ellipse(i*.5,0,i*.6,i*.3),e.pop();e.fill("#FFD93D"),e.circle(0,0,i*.3),e.pop()}}}pattern2_DottedSquare(){return{id:2,name:"Dotted Square",difficulty:1,symmetryAxes:4,layers:[],culturalNote:"Grid-based designs (Kolam) start with a pattern of dots.",generate:(e,n,t,i)=>{e.push(),e.translate(n,t),e.fill("#FF8C42"),e.noStroke();let r=4,c=i*1.5/r,g=(r-1)*c/2;for(let p=0;p<r;p++)for(let v=0;v<r;v++)e.circle(p*c-g,v*c-g,i*.16);e.pop()}}}pattern3_SixPointStar(){return{id:3,name:"Six-Point Star",difficulty:2,symmetryAxes:6,culturalNote:"Geometric harmony representing the balance of elements.",layers:[],generate:(e,n,t,i)=>{e.push(),e.translate(n,t),e.noFill(),e.strokeWeight(3),e.stroke("#4ECDC4"),e.beginShape();for(let r=0;r<6;r++){let c=e.TWO_PI/6*r;e.vertex(e.cos(c)*i*.4,e.sin(c)*i*.4)}e.endShape(e.CLOSE),e.stroke("#556270");for(let r=0;r<6;r++)e.push(),e.rotate(e.TWO_PI/6*r),e.line(i*.4,0,i*.8,0),e.pop();e.pop()}}}pattern16_LotusMandala(){return{id:16,name:"Lotus Mandala",difficulty:3,symmetryAxes:8,culturalNote:"A complex lotus motif for festivals.",layers:[],generate:(e,n,t,i)=>{e.push(),e.translate(n,t),e.noStroke(),e.fill(280,60,80);for(let r=0;r<8;r++)e.push(),e.rotate(e.TWO_PI/8*r),e.beginShape(),e.vertex(0,0),e.bezierVertex(i*.3,-i*.2,i*.8,-i*.1,i*.9,0),e.bezierVertex(i*.8,i*.1,i*.3,i*.2,0,0),e.endShape(),e.pop();e.fill(50,80,100),e.circle(0,0,i*.2),e.pop()}}}pattern36_PeacockBloom(){return{id:36,name:"Peacock Bloom",difficulty:5,symmetryAxes:12,culturalNote:"The national bird of India, representing grace.",layers:[],generate:(e,n,t,i)=>{e.push(),e.translate(n,t),e.colorMode(e.HSB);for(let r=0;r<12;r++)e.push(),e.rotate(e.TWO_PI/12*r),e.stroke(200,80,80),e.strokeWeight(2),e.noFill(),e.bezier(0,0,i*.3,-i*.1,i*.6,-i*.1,i,0),e.bezier(0,0,i*.3,i*.1,i*.6,i*.1,i,0),e.fill(120,80,80),e.ellipse(i*.8,0,i*.15,i*.1),e.fill(280,80,80),e.circle(i*.8,0,i*.05),e.pop();e.pop()}}}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275prov=R({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var ue=(()=>{class a{constructor(){this.worker=null,typeof Worker<"u"?this.worker=new Worker(new URL("worker-3G45CUIO.js",import.meta.url),{type:"module"}):console.warn("Web Workers are not supported in this environment.")}calculateScore(e,n){return new Promise((t,i)=>{if(!this.worker){t(0);return}let r=e.getContext("2d"),c=n.getContext("2d");if(!r||!c){t(0);return}let g=r.getImageData(0,0,e.width,e.height).data,p=c.getImageData(0,0,n.width,n.height).data;this.worker.onmessage=({data:v})=>{t(v)},this.worker.onerror=v=>{console.error("Worker error:",v),i(v)},this.worker.postMessage({playerImageData:g,targetImageData:p,tolerance:15})})}terminate(){this.worker?.terminate()}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275prov=R({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var oe=class{constructor(){this.DB_NAME="ShilpaRangoliDB",this.DB_VERSION=2,this.dbPromise=this.openDB()}openDB(){return new Promise((m,e)=>{let n=indexedDB.open(this.DB_NAME,this.DB_VERSION);n.onupgradeneeded=t=>{let i=t.target.result;i.objectStoreNames.contains("progress")||i.createObjectStore("progress",{keyPath:"playerId"}),i.objectStoreNames.contains("sessions")||i.createObjectStore("sessions",{keyPath:"sessionId"}).createIndex("stage","stage",{unique:!1})},n.onsuccess=()=>m(n.result),n.onerror=()=>e(n.error)})}get(m,e){return S(this,null,function*(){let n=yield this.dbPromise;return new Promise((t,i)=>{let c=n.transaction(m,"readonly").objectStore(m).get(e);c.onsuccess=()=>t(c.result),c.onerror=()=>i(c.error)})})}put(m,e){return S(this,null,function*(){let n=yield this.dbPromise;return new Promise((t,i)=>{let r=n.transaction(m,"readwrite");r.objectStore(m).put(e),r.oncomplete=()=>t(),r.onerror=()=>i(r.error)})})}clear(m){return S(this,null,function*(){let e=yield this.dbPromise;return new Promise((n,t)=>{let i=e.transaction(m,"readwrite");i.objectStore(m).clear(),i.oncomplete=()=>n(),i.onerror=()=>t(i.error)})})}delete(m,e){return S(this,null,function*(){let n=yield this.dbPromise;return new Promise((t,i)=>{let r=n.transaction(m,"readwrite");r.objectStore(m).delete(e),r.oncomplete=()=>t(),r.onerror=()=>i(r.error)})})}},fe=(()=>{class a{constructor(){this.STORAGE_KEY="rangoli-learning-progress-v1",this.GURU_KEY="shilparangoli-guru-progress",this.PLAYER_KEY="shilparangoli-player-id",this.db=new oe,this.playerId=this.getOrCreatePlayerId(),this.currentStage=C(1),this.guruScore=C(0),this.progressSubject=new se(null),this.progress$=this.progressSubject.asObservable(),this.legacyProgress=this.loadLegacyProgress(),this.loadProgress()}loadLegacyProgress(){let e=localStorage.getItem(this.STORAGE_KEY);if(e)try{return JSON.parse(e)}catch{}return{playerId:this.playerId,patternsCompleted:{},totalXP:0,badges:[],settings:{audioEnabled:!0,showGuideGrid:!0,targetOpacity:50}}}saveLegacyProgress(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.legacyProgress))}isPatternUnlocked(e){if(e===1)return!0;let n=this.legacyProgress.patternsCompleted[e-1];return!!(n&&n.completed)}completePattern(e,n,t){let i=this.legacyProgress.patternsCompleted[e]||{completed:!1,bestAccuracy:0,stars:0,attempts:0,totalTimeSeconds:0,completedAt:""};i.completed=!0,i.attempts++,i.totalTimeSeconds+=t,i.completedAt=new Date().toISOString(),n>i.bestAccuracy&&(i.bestAccuracy=n,n>=95?i.stars=5:n>=85?i.stars=4:n>=75?i.stars=3:n>=60?i.stars=2:i.stars=1),this.legacyProgress.totalXP+=10+i.stars*5,this.legacyProgress.patternsCompleted[e]=i,this.saveLegacyProgress()}getPatternStatus(e){return this.legacyProgress.patternsCompleted[e]}getProgress(){return this.legacyProgress}getOrCreatePlayerId(){let e=localStorage.getItem(this.PLAYER_KEY);return e||(e=`player_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(this.PLAYER_KEY,e)),e}loadProgress(){return S(this,null,function*(){try{let e=yield this.db.get("progress",this.playerId);e||(e=this.createFreshProgress(),yield this.db.put("progress",e)),this.applyProgress(e)}catch(e){console.warn("[ProgressTracker] IndexedDB unavailable, falling back to localStorage",e),this.loadFromLocalStorage()}})}createFreshProgress(){return{playerId:this.playerId,currentStage:1,stageCompletions:Array.from({length:5},(e,n)=>({stage:n+1,isUnlocked:n===0,isCompleted:!1,attemptCount:0,bestMetrics:{pressureConsistency:0,velocityConsistency:0,angularPrecision:0,strokeOrderCompliance:0,flowStateIndex:0}})),guruScore:0,totalPracticeTime:0,achievements:[],lastSession:Date.now()}}applyProgress(e){this.currentStage.set(e.currentStage),this.guruScore.set(e.guruScore),this.progressSubject.next(e)}startSession(e,n){return S(this,null,function*(){let t=`s_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,i={sessionId:t,patternId:e,stage:n,startTime:Date.now(),endTime:0,metrics:{pressureConsistency:0,velocityConsistency:0,angularPrecision:0,strokeOrderCompliance:0,flowStateIndex:0},strokes:[]};try{yield this.db.put("sessions",i)}catch{}return t})}completeSession(e,n,t,i,r){return S(this,null,function*(){let c={sessionId:e,patternId:t,stage:n,startTime:Date.now()-r,endTime:Date.now(),metrics:i,strokes:[]};try{yield this.db.put("sessions",c)}catch{}let g;try{g=(yield this.db.get("progress",this.playerId))??this.createFreshProgress()}catch{g=this.loadLocalProgress()??this.createFreshProgress()}let p=this.getThreshold(n),O=this.compositeScore(i,n)>=p,b=g.stageCompletions[n-1];b.attemptCount++,O&&!b.isCompleted&&(b.isCompleted=!0,b.completedAt=Date.now(),n<5&&(g.stageCompletions[n].isUnlocked=!0,g.currentStage=n+1,this.currentStage.set(n+1))),this.isBetter(i,b.bestMetrics)&&(b.bestMetrics=i);let I=this.checkAchievements(g,i);g.guruScore=this.calcGuruScore(g),this.guruScore.set(g.guruScore),g.totalPracticeTime+=r,g.lastSession=Date.now();try{yield this.db.put("progress",g)}catch{this.saveLocalProgress(g)}this.progressSubject.next(g);let F=this.buildFeedback(i,n,O);return{passed:O,guruScore:g.guruScore,feedback:F,newAchievements:I}})}getThreshold(e){return[0,.7,.75,.8,.85,.9][e]??.8}compositeScore(e,n){let t=this.stageWeights(n);return e.pressureConsistency*t.pressure+e.velocityConsistency*t.velocity+e.angularPrecision*t.angular+e.strokeOrderCompliance*t.strokeOrder+e.flowStateIndex*t.flowState}stageWeights(e){let n={1:{pressure:.4,velocity:.2,angular:.2,strokeOrder:.1,flowState:.1},2:{pressure:.25,velocity:.35,angular:.2,strokeOrder:.1,flowState:.1},3:{pressure:.2,velocity:.2,angular:.4,strokeOrder:.1,flowState:.1},4:{pressure:.15,velocity:.15,angular:.2,strokeOrder:.35,flowState:.15},5:{pressure:.15,velocity:.15,angular:.2,strokeOrder:.2,flowState:.3}};return n[e]??n[1]}calcGuruScore(e){let n=e.stageCompletions.filter(g=>g.isCompleted);if(n.length===0)return 0;let t=n.reduce((g,p)=>g+this.compositeScore(p.bestMetrics,p.stage),0)/n.length,i=n.length===5?.1:0,r=e.totalPracticeTime/36e5,c=Math.min(.1,Math.log10(r+1)*.05);return Math.min(100,Math.round((t+i+c)*100))}isBetter(e,n){let t=i=>i.pressureConsistency+i.velocityConsistency+i.angularPrecision+i.strokeOrderCompliance+i.flowStateIndex;return t(e)>t(n)}checkAchievements(e,n){let t=[],i=c=>e.achievements.some(g=>g.id===c),r=c=>{t.push(c),e.achievements.push(c)};return e.stageCompletions[0].isCompleted&&!i("first_blood")&&r({id:"first_blood",name:"First Steps",description:"Completed the Foundation stage!",unlockedAt:Date.now(),icon:"\u{1F331}"}),Object.values(n).some(c=>c>.95)&&!i("perfect_precision")&&r({id:"perfect_precision",name:"Perfect Precision",description:"Achieved 95%+ in a skill metric",unlockedAt:Date.now(),icon:"\u{1F3AF}"}),n.flowStateIndex>.9&&!i("flow_master")&&r({id:"flow_master",name:"Flow Master",description:"Entered a true flow state",unlockedAt:Date.now(),icon:"\u{1F30A}"}),e.totalPracticeTime>=36e5&&!i("marathon")&&r({id:"marathon",name:"Marathon",description:"Over 1 hour of practice!",unlockedAt:Date.now(),icon:"\u23F1\uFE0F"}),e.stageCompletions.every(c=>c.isCompleted)&&!i("guru")&&r({id:"guru",name:"Guru",description:"Mastered all 5 stages. You are ready to teach.",unlockedAt:Date.now(),icon:"\u{1F3C6}"}),t}buildFeedback(e,n,t){let i=[],r=this.stageWeights(n),c={pressure:e.pressureConsistency*r.pressure,velocity:e.velocityConsistency*r.velocity,angular:e.angularPrecision*r.angular,strokeOrder:e.strokeOrderCompliance*r.strokeOrder,flowState:e.flowStateIndex*r.flowState},g=Object.entries(c).sort((b,I)=>b[1]-I[1])[0][0],v={1:{pressure:'Grip pressure varies too much. Try the "grain of rice" hold.',velocity:"Focus on steady hand movement\u2014draw as if underwater."},2:{velocity:"Work on constant speed. Use a metronome at 60 BPM.",flowState:"Too tense. Try the 4-2-6 breathing exercise first."},3:{angular:"Angles are off. Use the clock-face visualization: 12, 3, 6, 9."},4:{strokeOrder:"Stroke sequence matters! Review the inside-out principle."},5:{flowState:"Not in flow yet. Eliminate distractions and do 30-min uninterrupted practice."}}[n],O=v?v[g]:void 0;return O&&i.push(O),i.unshift(t?"\u2728 Stage passed! Excellent technique \u2014 ready for the next challenge.":"\u{1F4A1} Not quite there yet. Keep at it:"),i}loadFromLocalStorage(){let e=this.loadLocalProgress();e?this.applyProgress(e):this.applyProgress(this.createFreshProgress())}loadLocalProgress(){try{let e=localStorage.getItem(this.GURU_KEY);return e?JSON.parse(e):null}catch{return null}}saveLocalProgress(e){try{localStorage.setItem(this.GURU_KEY,JSON.stringify(e))}catch{}}getMasteryProgress(){return this.progress$}isStageUnlocked(e){let n=this.progressSubject.getValue();return n?n.stageCompletions[e-1]?.isUnlocked??!1:e===1}resetGuruProgress(){return S(this,null,function*(){try{yield this.db.delete("progress",this.playerId),yield this.db.clear("sessions")}catch{}localStorage.removeItem(this.GURU_KEY);let e=this.createFreshProgress();this.applyProgress(e)})}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275prov=R({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var Oe=["targetCanvas"],Ie=["playerCanvas"],ve=()=>[1,2,3,4,5];function Ee(a,m){a&1&&x(0,"app-onboarding")}function Te(a,m){if(a&1&&(o(0,"div",20)(1,"span",21),d(2),s(),o(3,"div")(4,"strong"),d(5),s(),o(6,"p"),d(7),s()()()),a&2){let e=m.$implicit;l(2),u(e.icon),l(3),u(e.title),l(2),u(e.description)}}function Ae(a,m){if(a&1){let e=A();o(0,"div",11),P("click",function(t){return y(e),_(t.stopPropagation())}),o(1,"button",12),P("click",function(){y(e);let t=h(2);return _(t.closeInfoPopover())}),d(2,"\u2715"),s(),o(3,"div",13)(4,"span",14),d(5),s(),o(6,"h2"),d(7),s()(),o(8,"div",15),k(9,Te,8,3,"div",16),s(),o(10,"div",17)(11,"span",18),d(12,"\u{1F4DA}"),s(),o(13,"div")(14,"strong"),d(15),s(),o(16,"p"),d(17),s()()(),o(18,"div",19)(19,"span"),d(20,"\u{1F3AF} Pass condition:"),s(),d(21),s()()}if(a&2){let e=m.ngIf;l(5),M("Stage ",e.stage,""),l(2),u(e.technique),l(2),f("ngForOf",e.guideItems),l(6),u(e.culturalContext.tradition),l(2),u(e.culturalContext.citation),l(4),M(" ",e.passThreshold," ")}}function Le(a,m){if(a&1){let e=A();o(0,"div",9),P("click",function(){y(e);let t=h();return _(t.closeInfoPopover())}),k(1,Ae,22,6,"div",10),s()}if(a&2){let e=h();l(),f("ngIf",e.stageGuide())}}function Re(a,m){if(a&1&&(o(0,"span"),d(1),s()),a&2){let e=h().$implicit;l(),u(e)}}function Fe(a,m){a&1&&(o(0,"span"),d(1,"\u{1F512}"),s())}function De(a,m){if(a&1&&(o(0,"div",34)(1,"div",35),k(2,Re,2,1,"span",3)(3,Fe,2,0,"span",3),s(),o(4,"span",36),d(5),s()()),a&2){let e=m.$implicit,n=h(2);T("unlocked",n.stageIsUnlocked(e))("active",n.currentStage()===e),l(2),f("ngIf",n.stageIsUnlocked(e)),l(),f("ngIf",!n.stageIsUnlocked(e)),l(2),u(n.stageGuides[e-1].stageName)}}function ze(a,m){a&1&&(o(0,"span",46),d(1,"\u{1F512}"),s())}function We(a,m){if(a&1&&(o(0,"span"),d(1,"\u2605"),s()),a&2){let e=m.$implicit,n=h().$implicit;T("filled",e<=n.difficulty)}}function Ve(a,m){if(a&1){let e=A();o(0,"div",37),P("click",function(){let t=y(e).$implicit,i=h(2);return _(i.selectPattern(t))}),o(1,"div",38),x(2,"div",39)(3,"div",40),k(4,ze,2,0,"span",41),s(),o(5,"div",42)(6,"h3"),d(7),s(),o(8,"div",43),k(9,We,2,2,"span",44),s(),o(10,"span",45),d(11),s()()()}if(a&2){let e=m.$implicit,n=h(2);T("locked",!n.isUnlocked(e.id)),l(2),w("background","hsl("+e.id*20+", 55%, 25%)"),l(2),f("ngIf",!n.isUnlocked(e.id)),l(3),u(e.name),l(2),f("ngForOf",ie(8,ve)),l(2),M("",e.symmetryAxes,"-fold")}}function Ge(a,m){if(a&1){let e=A();o(0,"div",22)(1,"header",23)(2,"a",24),d(3,"\u2190 Modes"),s(),o(4,"h1"),d(5,"Guru Protocol"),s(),o(6,"div",25)(7,"span",26),d(8),s(),o(9,"span",27),d(10,"Guru Score"),s()()(),o(11,"div",28),k(12,De,6,7,"div",29),s(),o(13,"div",30)(14,"button",31),P("click",function(){y(e);let t=h();return _(t.galleryTier="Beginner")}),d(15,"Beginner"),s(),o(16,"button",31),P("click",function(){y(e);let t=h();return _(t.galleryTier="Intermediate")}),d(17,"Intermediate"),s(),o(18,"button",31),P("click",function(){y(e);let t=h();return _(t.galleryTier="Advanced")}),d(19,"Advanced"),s()(),o(20,"div",32),k(21,Ve,12,9,"div",33),s()()}if(a&2){let e=h();l(6),w("color",e.guruScoreColor()),l(2),u(e.guruScore()),l(4),f("ngForOf",ie(11,ve)),l(2),T("active",e.galleryTier==="Beginner"),l(2),T("active",e.galleryTier==="Intermediate"),l(2),T("active",e.galleryTier==="Advanced"),l(3),f("ngForOf",e.filteredPatterns)}}function je(a,m){if(a&1){let e=A();o(0,"div",47)(1,"div",48)(2,"h2"),d(3),s(),o(4,"p",49),d(5),s(),o(6,"div",50)(7,"div",51)(8,"span",52),d(9),s(),o(10,"span",53),d(11,"-fold symmetry"),s()(),o(12,"div",51)(13,"span",52),d(14),s(),o(15,"span",53),d(16,"/5 difficulty"),s()(),o(17,"div",51)(18,"span",52),d(19),s(),o(20,"span",53),d(21,"stage"),s()()(),o(22,"div",54)(23,"button",55),P("click",function(){y(e);let t=h();return _(t.startLevel())}),d(24,"Begin Drawing"),s(),o(25,"button",56),P("click",function(){y(e);let t=h();return _(t.gameState="GALLERY")}),d(26,"Back"),s()()()()}if(a&2){let e=h();l(3),u(e.currentPattern.name),l(2),u(e.currentPattern.culturalNote),l(4),u(e.currentPattern.symmetryAxes),l(5),u(e.currentPattern.difficulty),l(5),u(e.stageLabel())}}function Be(a,m){if(a&1){let e=A();o(0,"div",57)(1,"div",58)(2,"button",59),P("click",function(){y(e);let t=h();return _(t.backToGallery())}),d(3,"\u2715 Quit"),s(),o(4,"div",60)(5,"span",61),d(6),s(),o(7,"button",62),P("click",function(){y(e);let t=h();return _(t.openInfoPopover())}),d(8,"\u2139"),s()(),o(9,"div",63)(10,"div",64)(11,"span",65),d(12,"Grip"),s(),o(13,"div",66),x(14,"div",67),s()(),o(15,"div",64)(16,"span",65),d(17,"Flow"),s(),o(18,"div",66),x(19,"div",68),s()(),o(20,"div",64)(21,"span",65),d(22,"Angle"),s(),o(23,"div",66),x(24,"div",69),s()()(),o(25,"div",70)(26,"span"),d(27),s(),o(28,"div",71),x(29,"div",72),s()(),o(30,"div",73)(31,"label",74)(32,"input",75),ne("ngModelChange",function(t){y(e);let i=h();return te(i.showGhostOverlay,t)||(i.showGhostOverlay=t),_(t)}),s(),o(33,"span"),d(34,"\u{1F47B}"),s()(),o(35,"label",74)(36,"input",75),ne("ngModelChange",function(t){y(e);let i=h();return te(i.showGuides,t)||(i.showGuides=t),_(t)}),s(),o(37,"span"),d(38,"\u{1F4CF}"),s()()(),o(39,"button",76),P("click",function(){y(e);let t=h();return _(t.finishLevel())}),d(40,"Finish \u2713"),s()(),o(41,"div",77)(42,"div",78)(43,"div",79),d(44,"Target"),s(),x(45,"div",80,0),s(),o(47,"div",81)(48,"div",79),d(49,"Your Drawing"),s(),x(50,"div",80,1),s()()()}if(a&2){let e=h();l(6),U("Stage ",e.currentStage()," \xB7 ",e.stageLabel(),""),l(8),w("width",e.metricPct(e.liveMetrics().pressureConsistency),"%"),l(5),w("width",e.metricPct(e.liveMetrics().velocityConsistency),"%"),l(5),w("width",e.metricPct(e.liveMetrics().angularPrecision),"%"),l(3),M("",e.accuracy,"%"),l(2),w("width",e.accuracy,"%"),l(3),ee("ngModel",e.showGhostOverlay),l(4),ee("ngModel",e.showGuides)}}function Ye(a,m){if(a&1&&(o(0,"p",100),d(1),s()),a&2){let e=m.$implicit;l(),u(e)}}function Ne(a,m){if(a&1&&(o(0,"div",103)(1,"span",104),d(2),s(),o(3,"div")(4,"strong"),d(5),s(),o(6,"p"),d(7),s()()()),a&2){let e=m.$implicit;l(2),u(e.icon),l(3),u(e.name),l(2),u(e.description)}}function Ue(a,m){if(a&1&&(o(0,"div",101),k(1,Ne,8,3,"div",102),s()),a&2){let e=h(2);l(),f("ngForOf",e.newAchievements)}}function qe(a,m){if(a&1){let e=A();o(0,"button",55),P("click",function(){y(e);let t=h(2);return _(t.startLevel())}),d(1,"Try Again"),s()}}function Ke(a,m){if(a&1){let e=A();o(0,"div",82)(1,"div",83)(2,"div",84)(3,"span",85),d(4),s(),o(5,"h1"),d(6),s(),o(7,"div",86),d(8),o(9,"sup"),d(10,"%"),s()()(),o(11,"div",87)(12,"h3"),d(13,"Skill Metrics"),s(),o(14,"div",88)(15,"span"),d(16,"Grip Steady"),s(),o(17,"div",89),x(18,"div",90),s(),o(19,"span",91),d(20),s()(),o(21,"div",88)(22,"span"),d(23,"Flow"),s(),o(24,"div",89),x(25,"div",90),s(),o(26,"span",91),d(27),s()(),o(28,"div",88)(29,"span"),d(30,"Angle"),s(),o(31,"div",89),x(32,"div",90),s(),o(33,"span",91),d(34),s()(),o(35,"div",88)(36,"span"),d(37,"Flow State"),s(),o(38,"div",89),x(39,"div",92),s(),o(40,"span",91),d(41),s()()(),o(42,"div",93),k(43,Ye,2,1,"p",94),s(),k(44,Ue,2,1,"div",95),o(45,"div",96)(46,"span",97),d(47,"Guru Score"),s(),o(48,"span",98),d(49),s()(),o(50,"div",54),k(51,qe,2,0,"button",99),o(52,"button",56),P("click",function(){y(e);let t=h();return _(t.backToGallery())}),d(53,"Back to Gallery"),s()()()()}if(a&2){let e=h();l(),T("passed",e.sessionPassed),l(3),u(e.sessionPassed?"\u{1F389}":"\u{1F4AA}"),l(2),u(e.sessionPassed?"Level Mastered!":"Keep Practicing"),l(2),u(e.accuracy),l(10),w("width",e.metricPct(e.liveMetrics().pressureConsistency),"%"),l(2),M("",e.metricPct(e.liveMetrics().pressureConsistency),"%"),l(5),w("width",e.metricPct(e.liveMetrics().velocityConsistency),"%"),l(2),M("",e.metricPct(e.liveMetrics().velocityConsistency),"%"),l(5),w("width",e.metricPct(e.liveMetrics().angularPrecision),"%"),l(2),M("",e.metricPct(e.liveMetrics().angularPrecision),"%"),l(5),w("width",e.metricPct(e.liveMetrics().flowStateIndex),"%"),l(2),M("",e.metricPct(e.liveMetrics().flowStateIndex),"%"),l(2),f("ngForOf",e.sessionFeedback),l(),f("ngIf",e.newAchievements.length>0),l(4),w("color",e.guruScoreColor()),l(),u(e.finalGuruScore),l(2),f("ngIf",!e.sessionPassed)}}var Pt=(()=>{class a{constructor(e,n,t,i,r){this.onboarding=e,this.patternService=n,this.scoringService=t,this.progressService=i,this.cdr=r,this.patterns=[],this.currentPattern=null,this.gameState="GALLERY",this.galleryTier="Beginner",this.showGhostOverlay=!0,this.showGuides=!0,this.currentStage=C(1),this.guruScore=C(0),this.stageGuide=C(null),this.showInfoPopover=C(!1),this.accuracy=0,this.startTime=0,this.liveMetrics=C({pressureConsistency:0,velocityConsistency:0,angularPrecision:0,strokeOrderCompliance:0,flowStateIndex:0}),this.sessionId="",this.sessionStart=0,this.completedMetrics={pressureConsistency:0,velocityConsistency:0,angularPrecision:0,strokeOrderCompliance:0,flowStateIndex:0},this.sessionFeedback=[],this.sessionPassed=!1,this.newAchievements=[],this.finalGuruScore=0,this.pressureBuf=[],this.velocityPts=[],this.strokeAngles=[],this.strokeCounter=0,this.stageGuides=Y,this.GuruStage=re,this.stageLabel=G(()=>["Foundation","Control","Symmetry","Composition","Mastery"][this.currentStage()-1]??"Foundation"),this.guruScoreColor=G(()=>{let c=this.guruScore();return c>=85?"#4ECDC4":c>=65?"#FFD93D":c>=40?"#FF6B9D":"#a0a0c0"}),this.p5Target=null,this.p5Player=null,this.bioWorker=null,this.flowWorker=null,this.strokeWorker=null}ngOnInit(){this.patterns=this.patternService.getPatterns(),this.currentStage.set(this.progressService.currentStage()),this.guruScore.set(this.progressService.guruScore()),this.stageGuide.set(Y[this.currentStage()-1]),this.initWorkers()}ngOnDestroy(){this.cleanupP5(),this.terminateWorkers()}initWorkers(){try{this.bioWorker=new Worker(new URL("worker-IT6PFTTL.js",import.meta.url),{type:"module"}),this.flowWorker=new Worker(new URL("worker-UGQKEFH4.js",import.meta.url),{type:"module"}),this.strokeWorker=new Worker(new URL("worker-CZ2UUMP2.js",import.meta.url),{type:"module"})}catch(e){console.warn("[Workers] Web Workers unavailable, scoring in-thread.",e)}}terminateWorkers(){this.bioWorker?.terminate(),this.flowWorker?.terminate(),this.strokeWorker?.terminate(),this.bioWorker=this.flowWorker=this.strokeWorker=null}get filteredPatterns(){let e=this.galleryTier==="Beginner"?0:this.galleryTier==="Intermediate"?15:35,n=this.galleryTier==="Beginner"?15:this.galleryTier==="Intermediate"?35:50;return this.patterns.slice(e,n)}isUnlocked(e){return this.progressService.isPatternUnlocked(e)}selectPattern(e){this.progressService.isPatternUnlocked(e.id)&&(this.currentPattern=e,this.gameState="PREVIEW")}startLevel(){return S(this,null,function*(){this.currentPattern&&(this.gameState="PLAYING",this.startTime=Date.now(),this.sessionStart=Date.now(),this.resetLiveMetrics(),this.sessionId=yield this.progressService.startSession(this.currentPattern.id,this.currentStage()),this.cdr.detectChanges(),setTimeout(()=>this.initGameLoop(),100))})}initGameLoop(){if(this.cleanupP5(),!this.targetRef||!this.playerRef){console.error("Canvas elements not found in DOM");return}let e=t=>{t.setup=()=>{let i=this.targetRef.nativeElement.offsetWidth,r=this.targetRef.nativeElement.offsetHeight;t.createCanvas(i,r),t.noLoop(),this.renderTargetPattern(t)}},n=t=>{let i,r=0,c=0,g=0;t.setup=()=>{let p=this.playerRef.nativeElement.offsetWidth,v=this.playerRef.nativeElement.offsetHeight;t.createCanvas(p,v),i=t.createGraphics(p,v)},t.draw=()=>{if(t.background(10,10,20),this.showGuides&&this.currentPattern&&this.drawGuides(t),this.showGhostOverlay&&this.currentPattern&&(t.push(),t.drawingContext.globalAlpha=.18,this.currentPattern.generate(t,t.width/2,t.height/2,Math.min(t.width,t.height)*.4),t.pop()),t.image(i,0,0),t.mouseIsPressed&&this.isOnCanvas(t)){let p=t.width/2,v=t.height/2,O=t.millis(),b=t.mouseX-t.pmouseX,I=t.mouseY-t.pmouseY,F=O-g,D=F>0?Math.hypot(b,I)/F:0,E=this.getPressure(D);this.pressureBuf.push(E),this.velocityPts.push({x:t.mouseX,y:t.mouseY,t:O});let Z=Math.atan2(t.mouseY-v,t.mouseX-p)*(180/Math.PI);(t.mouseX-t.pmouseX)**2+(t.mouseY-t.pmouseY)**2>16&&this.strokeAngles.push((Z%360+360)%360),g=O,r=b,c=I,i.push(),i.stroke(255,107,157),i.strokeWeight(3+E*5),i.strokeCap(t.ROUND),i.line(t.pmouseX,t.pmouseY,t.mouseX,t.mouseY),i.pop(),this.drawPressureBar(t,E)}},t.mouseReleased=()=>{this.strokeCounter++,this.onStrokeEnd()}};this.p5Target=new j(e,this.targetRef.nativeElement),this.p5Player=new j(n,this.playerRef.nativeElement)}isOnCanvas(e){return e.mouseX>=0&&e.mouseX<=e.width&&e.mouseY>=0&&e.mouseY<=e.height}getPressure(e){let n=this.playerRef?.nativeElement?.querySelector("canvas");if(n){let i=n.__lastPressure;if(i&&i>0)return i}return .55+(1-Math.min(e,5)/5)*.2}onStrokeEnd(){return S(this,null,function*(){if(this.pressureBuf.length===0)return;let[e,n,t]=yield Promise.all([this.scorePressure(this.pressureBuf.slice()),this.scoreVelocity(this.velocityPts.slice()),this.scoreAngles(this.strokeAngles.slice(),this.currentPattern?.symmetryAxes??4)]),i={pressureConsistency:e,velocityConsistency:n,angularPrecision:t,strokeOrderCompliance:this.completedMetrics.strokeOrderCompliance||1,flowStateIndex:(e+n+t)/3};this.liveMetrics.set(i),this.updateVisualScore(),this.cdr.markForCheck()})}scorePressure(e){return new Promise(n=>{if(!this.bioWorker||e.length<2){n(.85);return}let t=i=>{this.bioWorker.removeEventListener("message",t),n(isNaN(i.data?.score)?.85:i.data.score)};this.bioWorker.addEventListener("message",t),this.bioWorker.postMessage({type:"COMPUTE_PRESSURE",pressureSamples:e})})}scoreVelocity(e){return new Promise(n=>{if(!this.flowWorker||e.length<3){n(.85);return}let t=i=>{this.flowWorker.removeEventListener("message",t),n(isNaN(i.data?.score)?.85:i.data.score)};this.flowWorker.addEventListener("message",t),this.flowWorker.postMessage({type:"COMPUTE_VELOCITY_CV",points:e})})}scoreAngles(e,n){return new Promise(t=>{if(!this.strokeWorker||e.length<2){t(.85);return}let i=r=>{this.strokeWorker.removeEventListener("message",i),t(isNaN(r.data?.score)?.85:r.data.score)};this.strokeWorker.addEventListener("message",i),this.strokeWorker.postMessage({type:"COMPUTE_ANGULAR_ERROR",strokeAngles:e,symmetryAxes:n})})}updateVisualScore(){if(!this.p5Player||!this.p5Target)return;let e=this.playerRef?.nativeElement?.querySelector("canvas"),n=this.targetRef?.nativeElement?.querySelector("canvas");e?.width>0&&n?.width>0&&this.scoringService.calculateScore(e,n).then(t=>{this.accuracy=isNaN(t)?0:Math.round(Math.max(0,Math.min(100,t))),this.cdr.markForCheck()}).catch(()=>{this.accuracy=0})}finishLevel(){return S(this,null,function*(){if(!this.currentPattern)return;let e=Date.now()-this.sessionStart,n=this.liveMetrics(),t=yield this.progressService.completeSession(this.sessionId,this.currentStage(),this.currentPattern.id,n,e);this.progressService.completePattern(this.currentPattern.id,this.accuracy,e/1e3),this.completedMetrics=n,this.sessionFeedback=t.feedback,this.sessionPassed=t.passed,this.newAchievements=t.newAchievements,this.finalGuruScore=t.guruScore,this.guruScore.set(t.guruScore),this.currentStage.set(this.progressService.currentStage()),this.stageGuide.set(Y[this.currentStage()-1]),this.gameState="RESULTS",this.cdr.markForCheck()})}renderTargetPattern(e){if(!this.currentPattern)return;e.background(10,10,20);let n=Math.min(e.width,e.height)*.4;this.currentPattern.generate(e,e.width/2,e.height/2,n)}drawGuides(e){let n=this.currentPattern?.symmetryAxes||4,t=e.width/2,i=e.height/2,r=Math.min(e.width,e.height)*.45;e.push(),e.translate(t,i),e.stroke(255,255,255,25),e.strokeWeight(1),e.noFill();for(let c=0;c<n;c++)e.push(),e.rotate(e.TWO_PI/n*c),e.line(0,0,r,0),e.pop();e.circle(0,0,r*.5),e.circle(0,0,r*1),e.pop()}drawPressureBar(e,n){let t=e.width-22,i=e.height*.6,r=(e.height-i)/2,c=n*i;e.push(),e.noStroke(),e.fill(255,255,255,15),e.rect(t,r,8,i,4);let g=this.pressureColor(n);e.fill(g.r,g.g,g.b,200),e.rect(t,r+i-c,8,c,4),e.fill(255,255,255,80),e.textSize(8),e.textAlign(e.CENTER),e.text("P",t+4,r-6),e.pop()}pressureColor(e){return e<.5?{r:78,g:205,b:196}:e<.75?{r:255,g:217,b:61}:{r:255,g:107,b:157}}openInfoPopover(){this.stageGuide.set(Y[this.currentStage()-1]),this.showInfoPopover.set(!0)}closeInfoPopover(){this.showInfoPopover.set(!1)}resetLiveMetrics(){this.pressureBuf=[],this.velocityPts=[],this.strokeAngles=[],this.strokeCounter=0,this.liveMetrics.set({pressureConsistency:0,velocityConsistency:0,angularPrecision:0,strokeOrderCompliance:0,flowStateIndex:0})}cleanupP5(){this.p5Target?.remove(),this.p5Player?.remove(),this.p5Target=this.p5Player=null}backToGallery(){this.gameState="GALLERY",this.cleanupP5(),this.resetLiveMetrics(),this.newAchievements=[]}metricPct(e){return Math.round(e*100)}stageIsUnlocked(e){return this.progressService.isStageUnlocked(e)}static{this.\u0275fac=function(n){return new(n||a)(L(J),L(he),L(ue),L(fe),L(K))}}static{this.\u0275cmp=N({type:a,selectors:[["app-rangoli-learning"]],viewQuery:function(n,t){if(n&1&&(z(Oe,5),z(Ie,5)),n&2){let i;W(i=V())&&(t.targetRef=i.first),W(i=V())&&(t.playerRef=i.first)}},standalone:!0,features:[q],decls:7,vars:6,consts:[["targetCanvas",""],["playerCanvas",""],[1,"learning-root"],[4,"ngIf"],["class","popover-backdrop",3,"click",4,"ngIf"],["class","gallery-view",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],["class","playing-view",4,"ngIf"],["class","modal-backdrop results-backdrop",4,"ngIf"],[1,"popover-backdrop",3,"click"],["class","popover-card",3,"click",4,"ngIf"],[1,"popover-card",3,"click"],["aria-label","Close",1,"popover-close",3,"click"],[1,"popover-header"],[1,"popover-stage-label"],[1,"popover-items"],["class","popover-item",4,"ngFor","ngForOf"],[1,"popover-citation"],[1,"citation-icon"],[1,"popover-pass"],[1,"popover-item"],[1,"item-icon"],[1,"gallery-view"],[1,"gallery-header"],["routerLink","/game-mode",1,"back-btn"],[1,"guru-badge"],[1,"guru-score"],[1,"guru-label"],[1,"stage-stepper"],["class","stage-node",3,"unlocked","active",4,"ngFor","ngForOf"],[1,"tier-selector"],[3,"click"],[1,"pattern-grid"],["class","pattern-card",3,"locked","click",4,"ngFor","ngForOf"],[1,"stage-node"],[1,"node-circle"],[1,"node-label"],[1,"pattern-card",3,"click"],[1,"pattern-thumb"],[1,"placeholder-art"],[1,"pattern-shine"],["class","lock-icon",4,"ngIf"],[1,"pattern-info"],[1,"stars"],[3,"filled",4,"ngFor","ngForOf"],[1,"symmetry-tag"],[1,"lock-icon"],[1,"modal-backdrop"],[1,"modal-card"],[1,"cultural-note"],[1,"preview-stats"],[1,"stat"],[1,"stat-val"],[1,"stat-key"],[1,"modal-actions"],[1,"btn-primary",3,"click"],[1,"btn-ghost",3,"click"],[1,"playing-view"],[1,"hud"],[1,"hud-quit",3,"click"],[1,"hud-stage"],[1,"stage-pill"],["title","Stage guide",1,"info-btn",3,"click"],[1,"hud-metrics"],[1,"mini-metric"],[1,"mm-label"],[1,"mm-bar"],[1,"mm-fill","grip"],[1,"mm-fill","flow"],[1,"mm-fill","angle"],[1,"accuracy-chip"],[1,"acc-bar"],[1,"acc-fill"],[1,"hud-tools"],[1,"toggle-pill"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"btn-finish",3,"click"],[1,"canvas-split"],[1,"canvas-panel","target-panel"],[1,"panel-label"],[1,"canvas-host"],[1,"canvas-panel","player-panel"],[1,"modal-backdrop","results-backdrop"],[1,"modal-card","results-card"],[1,"results-header"],[1,"result-emoji"],[1,"visual-score"],[1,"skill-breakdown"],[1,"skill-row"],[1,"sk-bar"],[1,"sk-fill"],[1,"sk-val"],[1,"sk-fill","flow"],[1,"feedback-list"],["class","feedback-msg",4,"ngFor","ngForOf"],["class","achievements",4,"ngIf"],[1,"guru-score-display"],[1,"gsd-label"],[1,"gsd-val"],["class","btn-primary",3,"click",4,"ngIf"],[1,"feedback-msg"],[1,"achievements"],["class","ach-item",4,"ngFor","ngForOf"],[1,"ach-item"],[1,"ach-icon"]],template:function(n,t){n&1&&(o(0,"div",2),k(1,Ee,1,0,"app-onboarding",3)(2,Le,2,1,"div",4)(3,Ge,22,12,"div",5)(4,je,27,5,"div",6)(5,Be,52,13,"div",7)(6,Ke,54,23,"div",8),s()),n&2&&(l(),f("ngIf",!t.onboarding.isOnboardingComplete()),l(),f("ngIf",t.showInfoPopover()),l(),f("ngIf",t.gameState==="GALLERY"),l(),f("ngIf",t.gameState==="PREVIEW"&&t.currentPattern),l(),f("ngIf",t.gameState==="PLAYING"),l(),f("ngIf",t.gameState==="RESULTS"))},dependencies:[$,H,X,ae,me,ce,le,de,pe],styles:['[_nghost-%COMP%]{display:block;min-height:100vh;background:radial-gradient(ellipse at 50% 0%,#20192e,#111117 70%);color:#f2f2f3;font-family:Inter,system-ui,sans-serif}.learning-root[_ngcontent-%COMP%]{max-width:1440px;margin:0 auto;padding:0 1.5rem}.popover-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0a0a0fbf;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);z-index:100;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fade-in .25s ease}.popover-card[_ngcontent-%COMP%]{width:min(580px,96vw);background:#1e1e24;border:1px solid hsla(0,0%,100%,.07);border-radius:20px;padding:2rem;position:relative;animation:_ngcontent-%COMP%_scale-in .3s cubic-bezier(0,0,.2,1);box-shadow:0 20px 60px #0a0a0fa6;max-height:88vh;overflow-y:auto}.popover-close[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:#ffffff12;border:none;color:#a1a1aa;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:.8rem;transition:background .2s}.popover-close[_ngcontent-%COMP%]:hover{background:#ffffff1f;color:#fff}.popover-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.popover-header[_ngcontent-%COMP%]   .popover-stage-label[_ngcontent-%COMP%]{font-size:.72rem;letter-spacing:.1em;text-transform:uppercase;color:#fb5189;opacity:.75}.popover-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Crimson Pro,Georgia,serif;font-size:1.6rem;color:#fb5189;margin:.25rem 0 0}.popover-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1.25rem}.popover-item[_ngcontent-%COMP%]{display:flex;gap:.9rem;align-items:flex-start}.popover-item[_ngcontent-%COMP%]   .item-icon[_ngcontent-%COMP%]{font-size:1.3rem;flex-shrink:0}.popover-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.9rem;margin-bottom:.2rem;color:#f2f2f3}.popover-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.82rem;color:#a1a1aa;line-height:1.55}.popover-citation[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:.9rem 1rem;background:#b152e00f;border-left:3px solid hsla(280,70%,60%,.4);border-radius:0 10px 10px 0;margin-bottom:1rem}.popover-citation[_ngcontent-%COMP%]   .citation-icon[_ngcontent-%COMP%]{flex-shrink:0}.popover-citation[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.85rem;margin-bottom:.2rem;color:#ce93ec}.popover-citation[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.78rem;color:#a1a1aa}.popover-pass[_ngcontent-%COMP%]{background:#2dd27214;border:1px solid hsla(145,65%,50%,.2);border-radius:8px;padding:.6rem .9rem;font-size:.82rem;color:#81e4aa}.popover-pass[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;margin-right:.4rem}.gallery-view[_ngcontent-%COMP%]{padding:2rem 0}.gallery-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;margin-bottom:2rem}.gallery-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Crimson Pro,Georgia,serif;font-size:2.2rem;background:linear-gradient(120deg,#fb5189,#ffc61a);background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0}.back-btn[_ngcontent-%COMP%]{background:#ffffff0f;color:#a1a1aa;border:1px solid hsla(0,0%,100%,.07);padding:.45rem 1rem;border-radius:8px;cursor:pointer;text-decoration:none;font-size:.85rem;transition:all .2s;display:inline-block}.back-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#f2f2f3}.guru-badge[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.guru-badge[_ngcontent-%COMP%]   .guru-score[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;font-family:JetBrains Mono,monospace}.guru-badge[_ngcontent-%COMP%]   .guru-label[_ngcontent-%COMP%]{font-size:.65rem;letter-spacing:.12em;text-transform:uppercase;opacity:.6}.stage-stepper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;gap:0;margin-bottom:2rem;position:relative}.stage-stepper[_ngcontent-%COMP%]:before{content:"";position:absolute;top:20px;left:17%;right:17%;height:2px;background:#ffffff12}.stage-node[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;flex:1;gap:.4rem;z-index:1;opacity:.35;transition:opacity .3s}.stage-node.unlocked[_ngcontent-%COMP%]{opacity:.7}.stage-node.active[_ngcontent-%COMP%]{opacity:1}.node-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#26262c;border:2px solid hsla(0,0%,100%,.07);display:flex;align-items:center;justify-content:center;font-size:.9rem;font-weight:700;transition:all .3s}.stage-node.unlocked[_ngcontent-%COMP%]   .node-circle[_ngcontent-%COMP%]{border-color:#fb518966}.stage-node.active[_ngcontent-%COMP%]   .node-circle[_ngcontent-%COMP%]{background:#fb5189;border-color:#fb5189;box-shadow:0 0 20px #fb518973;color:#fff}.node-label[_ngcontent-%COMP%]{font-size:.68rem;text-align:center;color:#a1a1aa;letter-spacing:.04em}.tier-selector[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-bottom:2rem;flex-wrap:wrap}.tier-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1.5rem;border:1px solid hsla(0,0%,100%,.07);background:#26262c;border-radius:20px;cursor:pointer;font-size:.85rem;color:#a1a1aa;transition:all .25s}.tier-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:#fb5189;color:#fb5189}.tier-selector[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fb5189;color:#fff;border-color:#fb5189;box-shadow:0 0 18px #fb518959}.pattern-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1.5rem;padding-bottom:3rem}.pattern-card[_ngcontent-%COMP%]{background:#26262c;border:1px solid hsla(0,0%,100%,.07);border-radius:16px;overflow:hidden;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1)}.pattern-card[_ngcontent-%COMP%]:hover:not(.locked){transform:translateY(-6px);border-color:#fb518966;box-shadow:0 12px 32px #00000059}.pattern-card.locked[_ngcontent-%COMP%]{opacity:.45;cursor:not-allowed;filter:grayscale(.6)}.pattern-thumb[_ngcontent-%COMP%]{height:150px;position:relative;overflow:hidden}.pattern-thumb[_ngcontent-%COMP%]   .placeholder-art[_ngcontent-%COMP%]{width:100%;height:100%;opacity:.8}.pattern-thumb[_ngcontent-%COMP%]   .pattern-shine[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(135deg,hsla(0,0%,100%,.06) 0%,transparent 50%)}.pattern-thumb[_ngcontent-%COMP%]   .lock-icon[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:1.6rem;background:#00000080}.pattern-info[_ngcontent-%COMP%]{padding:1rem}.pattern-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .35rem;font-size:.95rem}.pattern-info[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]{color:#fff3;font-size:.85rem}.pattern-info[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]   .filled[_ngcontent-%COMP%]{color:#ffc61a}.pattern-info[_ngcontent-%COMP%]   .symmetry-tag[_ngcontent-%COMP%]{font-size:.68rem;color:#a1a1aa;opacity:.6;margin-top:.25rem;display:block}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0a0a0fcc;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);z-index:100;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fade-in .3s ease}.modal-card[_ngcontent-%COMP%]{width:min(480px,95vw);background:#1e1e24;border:1px solid hsla(0,0%,100%,.07);border-radius:24px;padding:2.5rem;text-align:center;animation:_ngcontent-%COMP%_scale-in .3s cubic-bezier(0,0,.2,1);box-shadow:0 24px 64px #0a0a0fa6}.modal-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Crimson Pro,Georgia,serif;color:#fb5189;font-size:1.8rem;margin:0 0 .5rem}.cultural-note[_ngcontent-%COMP%]{color:#a1a1aa;font-size:.88rem;line-height:1.7;margin-bottom:1.5rem}.preview-stats[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2rem;margin-bottom:2rem}.preview-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.preview-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-val[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#fb5189}.preview-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-key[_ngcontent-%COMP%]{font-size:.7rem;color:#a1a1aa;text-transform:uppercase;letter-spacing:.06em}.playing-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;padding:.75rem 0;gap:.75rem}.hud[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.6rem 1.25rem;background:#1e1e24;border:1px solid hsla(0,0%,100%,.07);border-radius:14px;flex-wrap:wrap}.hud-quit[_ngcontent-%COMP%]{background:transparent;color:#a1a1aa;border:none;cursor:pointer;font-size:.85rem;padding:.3rem .6rem;border-radius:6px;transition:all .2s}.hud-quit[_ngcontent-%COMP%]:hover{color:#fff;background:#ffffff0f}.hud-stage[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;flex-shrink:0}.stage-pill[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:#fb5189;background:#fb51891a;border:1px solid hsla(340,95%,65%,.25);padding:.25rem .7rem;border-radius:20px}.info-btn[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;background:#26262c;border:1px solid hsla(0,0%,100%,.07);color:#a1a1aa;cursor:pointer;font-size:.75rem;transition:all .2s}.info-btn[_ngcontent-%COMP%]:hover{border-color:#fb5189;color:#fb5189}.hud-metrics[_ngcontent-%COMP%]{display:flex;gap:.75rem;flex:1}.mini-metric[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;flex:1}.mini-metric[_ngcontent-%COMP%]   .mm-label[_ngcontent-%COMP%]{font-size:.68rem;color:#a1a1aa;white-space:nowrap;width:36px}.mini-metric[_ngcontent-%COMP%]   .mm-bar[_ngcontent-%COMP%]{flex:1;height:5px;background:#ffffff12;border-radius:3px;overflow:hidden}.mini-metric[_ngcontent-%COMP%]   .mm-fill[_ngcontent-%COMP%]{height:100%;border-radius:3px;transition:width .5s ease}.mini-metric[_ngcontent-%COMP%]   .mm-fill.grip[_ngcontent-%COMP%]{background:linear-gradient(90deg,#9d26d9,#fb5189)}.mini-metric[_ngcontent-%COMP%]   .mm-fill.flow[_ngcontent-%COMP%]{background:linear-gradient(90deg,#11a4d4,#2dd272)}.mini-metric[_ngcontent-%COMP%]   .mm-fill.angle[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ffc61a,#f98c1f)}.accuracy-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;flex-shrink:0}.accuracy-chip[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem;font-weight:700;color:#5accf2;font-family:JetBrains Mono,monospace;width:42px}.accuracy-chip[_ngcontent-%COMP%]   .acc-bar[_ngcontent-%COMP%]{width:70px;height:5px;background:#ffffff12;border-radius:3px;overflow:hidden}.accuracy-chip[_ngcontent-%COMP%]   .acc-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2bbdee,#2dd272);transition:width .5s ease}.hud-tools[_ngcontent-%COMP%]{display:flex;gap:.4rem}.toggle-pill[_ngcontent-%COMP%]{display:flex;align-items:center;background:#26262c;border:1px solid hsla(0,0%,100%,.07);border-radius:20px;padding:.25rem .6rem;cursor:pointer;font-size:.85rem;transition:all .2s}.toggle-pill[_ngcontent-%COMP%]:has(input:checked){border-color:#fb518966;background:#fb518914}.toggle-pill[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:0;opacity:0;position:absolute}.btn-finish[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fb5189,#ee4b2b);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:24px;cursor:pointer;font-size:.88rem;font-weight:700;transition:all .2s;box-shadow:0 4px 16px #fb518959}.btn-finish[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 24px #fb518980}.canvas-split[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:1fr 1fr;gap:1rem;min-height:0}@media (max-width: 700px){.canvas-split[_ngcontent-%COMP%]{grid-template-columns:1fr}}.canvas-panel[_ngcontent-%COMP%]{background:#111117;border:1px solid hsla(0,0%,100%,.07);border-radius:16px;overflow:hidden;position:relative;min-height:300px;display:flex;flex-direction:column}.panel-label[_ngcontent-%COMP%]{position:absolute;top:.7rem;left:.7rem;background:#00000073;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);color:#ffffff8c;font-size:.72rem;letter-spacing:.06em;text-transform:uppercase;padding:.2rem .6rem;border-radius:4px;z-index:2}.canvas-host[_ngcontent-%COMP%]{flex:1}.canvas-host[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;width:100%!important;height:100%!important}.results-card[_ngcontent-%COMP%]{max-height:90vh;overflow-y:auto;text-align:left;padding:2rem}.results-card.passed[_ngcontent-%COMP%]   .results-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2dd272}.results-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.results-header[_ngcontent-%COMP%]   .result-emoji[_ngcontent-%COMP%]{font-size:2.5rem;display:block;margin-bottom:.5rem}.results-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Crimson Pro,Georgia,serif;font-size:1.8rem;margin:0 0 .5rem}.results-header[_ngcontent-%COMP%]   .visual-score[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;font-family:JetBrains Mono,monospace;color:#fb5189}.results-header[_ngcontent-%COMP%]   .visual-score[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{font-size:1.2rem;vertical-align:super;margin-left:2px}.skill-breakdown[_ngcontent-%COMP%]{margin-bottom:1.25rem}.skill-breakdown[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;letter-spacing:.1em;color:#a1a1aa;margin:0 0 .75rem}.skill-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:90px 1fr 44px;align-items:center;gap:.75rem;margin-bottom:.5rem;font-size:.8rem;color:#a1a1aa}.skill-row[_ngcontent-%COMP%]   .sk-bar[_ngcontent-%COMP%]{height:6px;background:#ffffff12;border-radius:3px;overflow:hidden}.skill-row[_ngcontent-%COMP%]   .sk-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#fb5189,#b152e0);transition:width .6s ease}.skill-row[_ngcontent-%COMP%]   .sk-fill.flow[_ngcontent-%COMP%]{background:linear-gradient(90deg,#2bbdee,#2dd272)}.skill-row[_ngcontent-%COMP%]   .sk-val[_ngcontent-%COMP%]{font-family:JetBrains Mono,monospace;font-size:.72rem;color:#fb5189;text-align:right}.feedback-list[_ngcontent-%COMP%]{margin-bottom:1rem}.feedback-msg[_ngcontent-%COMP%]{font-size:.84rem;line-height:1.6;color:#a1a1aa;margin:0 0 .4rem;padding:.5rem .75rem;background:#26262c;border-radius:8px;border-left:3px solid hsl(340,95%,65%)}.achievements[_ngcontent-%COMP%]{margin-bottom:1rem}.ach-item[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:flex-start;padding:.75rem;background:#ffc61a0f;border:1px solid hsla(45,100%,55%,.2);border-radius:10px;margin-bottom:.5rem}.ach-item[_ngcontent-%COMP%]   .ach-icon[_ngcontent-%COMP%]{font-size:1.4rem;flex-shrink:0}.ach-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.88rem;margin-bottom:.2rem;color:#ffc61a}.ach-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.78rem;color:#a1a1aa}.guru-score-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;background:#26262c;border-radius:10px;margin-bottom:1.5rem}.guru-score-display[_ngcontent-%COMP%]   .gsd-label[_ngcontent-%COMP%]{font-size:.75rem;text-transform:uppercase;letter-spacing:.1em;color:#a1a1aa}.guru-score-display[_ngcontent-%COMP%]   .gsd-val[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:800;font-family:JetBrains Mono,monospace}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fb5189,#ee4b2b);color:#fff;border:none;padding:.75rem 2rem;border-radius:30px;cursor:pointer;font-size:.95rem;font-weight:700;transition:all .2s;box-shadow:0 4px 20px #fb518959}.btn-primary[_ngcontent-%COMP%]:hover{transform:scale(1.04);box-shadow:0 6px 28px #fb518980}.btn-ghost[_ngcontent-%COMP%]{background:transparent;color:#a1a1aa;border:1px solid hsla(0,0%,100%,.07);padding:.75rem 2rem;border-radius:30px;cursor:pointer;font-size:.95rem;transition:all .2s}.btn-ghost[_ngcontent-%COMP%]:hover{background:#ffffff0f;color:#fff}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scale-in{0%{opacity:0;transform:scale(.92)}to{opacity:1;transform:scale(1)}}@media (max-width: 700px){.hud[_ngcontent-%COMP%]{gap:.5rem}.hud-metrics[_ngcontent-%COMP%]{display:none}.gallery-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem}.stage-stepper[_ngcontent-%COMP%]   .node-label[_ngcontent-%COMP%]{display:none}.modal-card[_ngcontent-%COMP%]{padding:1.5rem}}']})}}return a})();export{Pt as RangoliLearningComponent};
